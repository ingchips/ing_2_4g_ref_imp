# ING_BLE_2P4G_V1.0.0

## 该例程的作用？
  * 该例程演示了如何在ING916xx上使用桃芯自研2.4G的API进行通讯；
  * 桃芯自研的2.4G不同于标准的2.4G协议(例如ESB)，但运行方式和使用方式与其类似；
  * 桃芯自研的2.4G也与蓝牙协议不同，相对于蓝牙协议，它的使用更加灵活，也能获得更高的通讯速率；
  * 用户可以基于此例程弄明白桃芯2.4G的使用方式，并将它应用到键盘、鼠标等应用中。

## 如何测试该例程？
  * 找两套ING916的开发板，一块儿板子充当master，另外一块儿充当slave；
  * 使用ingWizard工具import该例程（假设已经安装好keil和ingWizard等必要环境）；
  * 右单击open project ...打开例程；
  * 将keil工程宏定义设置为 DEF_MASTER=1 ，即将工程设置为master，并编译程序；
  * 右单击ingWizard上工程启动downloader下载工具，用串口方式将master例程烧录到master的开发板上；
  * 将keil工程宏定义设置为 DEF_MASTER=0 ，即将工程设置为slave，并重新编译程序；
  * 用downloader将slave例程烧录到slave的开发板上；
  * 打开两个串口助手，分别观测两个开发板的串口日志，波特率115200；
  * 按下复位键，复位两个开发板，分别会打印开机日志；
  * 两个开发板开机默认处于BLE模式，按下一次KEY2按键，会切换到2.4G模式，再次按下一次KEY2键则进入到2.4G发送（master）和2.4G接收（slave）状态；
  * master开发板打印：【Start to TX ... 】则代表进入了发送状态；
  * slave开发板打印：【Start to RX ...】则代表进入了接收状态；
  * master开发板会统计发送与接收ACK的情况，会显示测试包数，丢失包数，和包速率等；

## 选用什么开发板
  * 选用ING916XX的开发板，一个功能板(版号：DB72C8K1A)+一个核心板(版号：DB682CC2A)组成一套开发板；
  * 每个开发板至少需要一个micro-USB数据线；
  * 注意核心板需要安装天线，以防信号较差，影响通讯速率。

## 一些重要信息
  * 目前master与slave通讯使用带应答的方式；
  * master发送和接收应答的流程如下：
    * master发送数据
    * slave接收数据
    * slave返回应答数据
    * master接收应答数据
  * 事件与中断：
    * slave接收到数据后会产生接收数据中断（可屏蔽）；
    * slave发送完应答后会产生接收过程结束事件中断（不可屏蔽），标记接收一个完整的包；
    * master发送完毕无中断事件；
    * master接收到应答会产生接收数据中断（可屏蔽）和接收事件中断（不可屏蔽）。
  * 从2.4G模式切换到BLE模式前，必须确保2.4G处于空闲状态；
  * 从BLE模式切换到2.4G模式前，必须确保BLE处于空闲状态，例如，没有广播、连接、扫描等事件。